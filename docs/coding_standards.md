# CommitNotes コーディング規約と技術仕様

## 1. プロジェクト概要

CommitNotesは、GitHubをデータベース代わりに活用し、Markdown形式でメモを管理できるElectronアプリです。オフライン編集に対応し、ユーザーが手動で`commit & push`することで、GitHub上でメモの履歴管理が可能になります。

## 2. 技術スタック

### 2.1 フロントエンド

- **React**: UIコンポーネントの構築
- **TypeScript**: 型安全なコード開発
- **Vite**: 高速な開発環境とビルドツール
- **Jotai**: 軽量な状態管理ライブラリ
- **Lexical**: リッチテキストエディタフレームワーク
- **TailwindCSS**: ユーティリティファーストCSSフレームワーク
- **DaisyUI**: TailwindCSSベースのUIコンポーネントライブラリ
- **Lucide**: アイコンライブラリ

### 2.2 バックエンド（Electron アプリ）

- **Electron**: クロスプラットフォームデスクトップアプリケーションフレームワーク
- **Node.js**: サーバーサイドJavaScript実行環境
- **isomorphic-git**: Gitコマンドの純JavaScript実装

### 2.3 データ管理

- **Markdownファイル**: ローカル保存およびGitHub同期
- **Electron Store**: アプリケーション設定のローカル保存

### 2.4 GitHub連携

- **GitHub API**: リモートリポジトリとの連携
- **Git操作**: commit, push, pull などの基本操作

### 2.5 追加機能技術

- **OpenAI API**: AIチャット機能（実装済み）
- **Pandoc**: ドキュメント変換（PDF/EPUB）（実装済み）

## 3. コーディング規約

### 3.1 全般的なルール

- インデントは**スペース2つ**を使用
- ファイル末尾は空行で終了
- UTF-8エンコーディングを使用
- 行末のスペースは削除

### 3.2 命名規則

- **コンポーネント**: PascalCase（例: `FileTree.tsx`, `MarkdownEditor.tsx`）
- **変数・関数**: camelCase（例: `getUserData()`, `fileContent`）
- **定数**: UPPER_CASE（例: `MAX_FILE_SIZE`, `DEFAULT_THEME`）
- **インターフェース**: 先頭に `I` を付ける（例: `IUserConfig`）
- **タイプ**: PascalCase（アッパーキャメルケース）で記述（例: `FileData`, `UserSettings`）

### 3.3 ファイル構成

- 1ファイルにつき1コンポーネントの原則を守る
- ファイル名はコンポーネント名と一致させる
- インポートは以下の順序で並べる：
  1. React/外部ライブラリ
  2. 内部コンポーネント
  3. 型定義
  4. スタイル

### 3.4 TypeScript

- `any`型の使用を避け、可能な限り明示的な型を定義
- インターフェースを使用して複雑な型を定義
- 関数は返り値の型を明示的に定義
- 非null型アサーション（`!`）の使用を最小限に留める

### 3.5 React

- 関数コンポーネントとHooksを使用
- クラスコンポーネントは使用しない
- 子コンポーネントへのpropsは型定義を行う
- 大きなコンポーネントは複数の小さなコンポーネントに分割

### 3.6 状態管理

- グローバル状態には**Jotai**を使用
- ローカル状態には`useState`を使用
- 複雑なロジックには`useReducer`を使用
- コンテキストを適切に利用してpropsのバケツリレーを避ける

### 3.7 スタイリング

- 第一候補として**DaisyUI**から適切なコンポーネントを選択
- DaisyUIで対応できない場合はTailwindCSSのユーティリティクラスを使用
- 複雑なコンポーネントに対しては@apply指示子を使用
- テーマ変数を適切に利用
- レスポンシブデザインを意識

## 4. プロジェクト構造

```
src/
├── main/              # Electronのメインプロセス
│   ├── main.ts        # エントリーポイント
│   ├── git/           # Git操作関連
│   └── fileSystem/    # ファイルシステム操作
├── renderer/          # レンダラープロセス（React）
│   ├── app.tsx        # Reactアプリケーション
│   ├── components/    # UIコンポーネント
│   │   ├── Editor/    # エディタ関連
│   │   ├── FileTree/  # ファイル一覧
│   │   └── GitOps/    # Git操作UI
│   ├── hooks/         # カスタムフック
│   └── store/         # 状態管理
└── preload/           # プリロードスクリプト
    └── preload.ts     # IPC通信の橋渡し
```

## 5. Git作業フロー

### 5.1 ブランチ戦略

- **main**: 安定版のコード
- **develop**: 開発中のコード
- **feature/XXX**: 機能追加用ブランチ
- **fix/XXX**: バグ修正用ブランチ

### 5.2 コミットメッセージ規約

以下のプレフィックスを使用:

- **feat**: 新機能
- **fix**: バグ修正
- **docs**: ドキュメント変更
- **style**: コードスタイル変更（機能に影響なし）
- **refactor**: リファクタリング
- **perf**: パフォーマンス改善
- **test**: テストの追加・修正
- **chore**: ビルド・補助ツール変更

例: `feat: ファイルツリー表示機能の実装`

## 6. テスト戦略（今後の予定）

### 6.1 テスト種別

- **単体テスト**: Vitestを使用予定
- **コンポーネントテスト**: React Testing Libraryを使用予定
- **E2Eテスト**: Playwright（必要に応じて）

### 6.2 テストカバレッジ

- 新機能は80%以上のカバレッジを目指す
- 重要な機能は100%のカバレッジを目指す

## 7. パフォーマンス目標

- アプリ起動: 3秒以内
- ファイルロード: 500ms以内
- 保存操作: 200ms以内
- Git操作UI応答: 300ms以内
- メモリ使用量: 300MB以下

## 8. 開発環境とツール

- **リンター**: ESLint
- **フォーマッター**: Prettier
- **ビルド**: Vite
- **デバッグ**: Chrome DevTools
- **パッケージマネージャー**: npm

## 9. リリースと配布戦略

- **バージョニング**: セマンティックバージョニング（major.minor.patch）
- **配布プラットフォーム**:
  - GitHub Releases
  - macOS: DMG
  - （将来的にWindowsにも対応予定）

## 10. ドキュメンテーション

- コードには適切なJSDocコメントを記載
- READMEにはインストール手順、基本的な使い方を記載
- `/docs`ディレクトリに詳細なドキュメントを配置

## 11. セキュリティ考慮事項

- GitHub認証情報は安全に保存
- API鍵は暗号化して保存
- ユーザーデータはローカルのみで保存
- XSS対策を実施
