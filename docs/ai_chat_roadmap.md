# AIチャット機能追加ロードマップ

## 機能概要

CommitNotesにAIとインラインチャットを行う機能を追加します。この機能により、ユーザーはメモの編集中にAIと対話し、文章の改善や質問への回答を得ることができます。

## 技術スタック追加

### AI連携

- OpenAI API
- Anthropic Claude API
- その他のLLM API（必要に応じて）

## 実装ステップ

### 1. AI API連携基盤の構築（1-2週間）

- [ ] AIプロバイダーの抽象化レイヤーの実装
  - 共通インターフェースの定義
  - OpenAI API実装
  - Claude API実装
- [ ] APIキー管理機能の実装
  - 安全なキー保存
  - キーの暗号化
- [ ] プロンプトテンプレート管理
  - テンプレートの定義
  - コンテキスト管理

### 2. チャットUI実装（2週間）

- [ ] チャットインターフェースの実装
  - チャットウィンドウのデザイン
  - メッセージ履歴の表示
  - 入力フォームの実装

### 3. コンテキスト管理機能（1-2週間）

- [ ] メモのコンテキスト抽出
  - 現在編集中のメモの内容取得
  - 関連するメモの検索
- [ ] 会話履歴の管理
  - セッション管理
  - 履歴の保存と読み込み
- [ ] プロンプトの最適化
  - コンテキストの適切な切り出し
  - トークン数の管理

### 4. 高度な機能実装（2週間）

- [ ] メモの自動改善機能
  - 文章校正
  - フォーマット修正
  - リンク提案
- [ ] コード支援機能
  - コード生成
  - バグ修正提案
  - コードレビュー
- [ ] 検索・要約機能
  - メモの要約生成
  - 関連メモの検索
  - 質問応答

## 技術的な詳細

### ファイル構造の追加

```
src/
├── main/
│   └── ai/              # AI関連の処理
│       ├── providers/   # AIプロバイダー実装
│       └── prompts/     # プロンプトテンプレート
├── renderer/
│   ├── components/
│   │   └── AIChat/      # チャットUI関連
│   ├── hooks/
│   │   └── useAI/       # AI関連のカスタムフック
│   └── store/
│       └── aiStore.ts   # AI関連の状態管理
└── types/
    └── ai.ts           # AI関連の型定義
```

### データフロー

1. **チャット開始**:

   - ユーザーが `/ai` コマンドを入力
   - 現在のメモのコンテキストを取得
   - AIプロバイダーを選択

2. **メッセージ送信**:

   - ユーザーの入力をプロンプトに変換
   - コンテキストと共にAPIに送信
   - ストリーミングレスポンスを受信

3. **応答処理**:

   - マークダウンのパース
   - コードブロックのシンタックスハイライト
   - UIへの表示

4. **履歴管理**:
   - 会話履歴の保存
   - セッション管理
   - コンテキストの更新

## セキュリティ考慮事項

1. **APIキーの保護**:

   - キーの暗号化保存
   - アクセス制御
   - 定期的なローテーション

2. **データプライバシー**:
   - 機密情報のフィルタリング
   - データの最小化
   - ユーザー同意の管理

## 結論

AIチャット機能の追加により、CommitNotesの機能性が大幅に向上し、より効率的なメモ作成と編集が可能になる
